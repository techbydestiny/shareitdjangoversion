{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Share It- Archieve</title>
      <!-- Latest compiled and minified CSS -->
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

      <link href="{% static 'dashboardcss/style.css' %}" rel="stylesheet"/>
  
</head>
<body>

   <div class="header">
        <nav class="navbar navbar-expand-lg">
            <div class="container-fluid">
                <!-- Logo and Search Bar (left section) -->
                <a class="navbar-brand d-flex align-items-center" href="/">
                    <img src="{% static 'logo.png' %}" width="60px" style="margin-right: 20px;"/>
                    {% if profile %}
                        <h3>Hello, {{ profile.user }}!</h3>
                    {% endif %}
                </a>

    
                <!-- Right section (icons, always visible) -->
                <div class="d-flex align-items-center">
                    <!-- Search icon for mobile -->
                    <a class="nav-link d-lg-none navbox" href="#"><i class="fas fa-search bright"></i></a>
                    <!-- Other icons -->
                    <a class="nav-link navbox" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Archieve"  href="/dashboard/archieve"><i class="fa-solid fa-box-archive bright"></i></a>
                    <a class="nav-link navbox" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Messages" href="/dashboard/messages"><i class="fab fa-facebook-messenger bright"></i></a>
                    <a class="nav-link navbox" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Profile" href="/dashboard/">
                        {% if profile.profile_pic %}
                            <img data-bs-toggle="tooltip" data-bs-placement="bottom" title="Profile" src="{{ profile.profile_pic.url }}" alt="Profile" class="profile-pic ms-2 bright">
                        {%else%}
                         <img data-bs-toggle="tooltip" data-bs-placement="bottom" title="Profile" src="{% static 'home/avatar.png' %}" alt="Profile" class="profile-pic ms-2 bright">
                         {%endif%}
                    </a>
                </div>
            </div>
        </nav>
    </div>


    <div class="body" style="background-image: url(&quot;{% static 'images/login-hero.jpg' %}&quot;);">

        <div class="container-fluid">

            <div>
                <div class="mt-4 p-5 text-white rounded archieve-card">
                    <div align="center">
                     <h2>Archieved Messages</h2>
                     <p>Saved Messages Will Be Stored Here</p>
                    </div>
                    <hr/>
                    <div class="messages">
                         {% for msg in savedmessages %}
                            <div id="message-{{ msg.id }}" class="card justified" style="width: 70%; margin-bottom: 20px;">
                                <div class="card-header">Message:</div>
                                <div class="card-body">
                                    <p>{{ msg.message }}</p>
                                    <p>- Anonymous [{{ msg.date|date:"d-m-Y" }} GMT]</p>
                                </div>
                                <div class="card-footer d-flex">
                                    <a href="{{ share_link }}" class="btn btn-custom2" target="_blank">
                                        Share <i class="fa-solid fa-share"></i>
                                    </a>
                                    <form method="POST" action="{% url 'delete_message' msg.id %}">
                                        {% csrf_token %}
                                        <button class="btn btn-custom2" type="submit"> Report <i class="fa-solid fa-flag"></i></button>
                                        <button class="btn btn-custom2" type="submit"> Delete <i class="fa-solid fa-trash-can"></i></button>
                                    </form>
                                </div>
                            </div>
                            {% empty %}
                            <p align="center">No Saved Messages yet.</p>
                            {% endfor %}
                    </div>
                    <div align="center" class="justified">
                        <button class="btn btn-custom centered" onclick="onBack()"><i class="fa-solid fa-backward"></i> Back</button>
                    </div>
                </div>
            </div>
        </div>



    </div>
    
<script>
function downloadMessageImage(elementId) {
    const element = document.getElementById(elementId);

    html2canvas(element, { scale: 2 }).then(canvas => {
        const link = document.createElement("a");
        link.download = "message.png";  // File name
        link.href = canvas.toDataURL("image/png");
        link.click();
    });
}
</script>
<!-- Latest compiled JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script> 
<script src="{%static 'js/script.js'%}"></script>
<script src="{% static 'js/buttons.js' %}"></script>

</body>
</html>